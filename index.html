<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cambio de Aceite a Domicilio</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    *{box-sizing:border-box;margin:0;padding:0;font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;}
    body{background:#121212;color:#e0e0e0;display:flex;justify-content:center;align-items:flex-start;min-height:100vh;padding:40px 10px;}
    .container{background:#1e1e1e;border-radius:12px;box-shadow:0 8px 25px rgba(0,0,0,0.7);padding:40px 30px;max-width:900px;width:100%;}
    h2{text-align:center;margin-bottom:30px;font-size:26px;color:#fff;}
    .form-group{position:relative;margin-bottom:22px;}
    .form-group i{position:absolute;top:50%;left:12px;transform:translateY(-50%);color:#888;font-size:16px;}
    .form-group input, .form-group select, .form-group textarea{
      width:100%;padding:14px 12px 14px 38px;border-radius:8px;border:none;background:#2a2a2a;color:#e0e0e0;font-size:15px;transition:all .3s;
    }
    .form-group input:focus, .form-group select:focus, .form-group textarea:focus{
      outline:none;background:#333;box-shadow:0 0 8px #0b5ed7;
    }
    .form-group label{
      position:absolute;top:50%;left:38px;transform:translateY(-50%);
      pointer-events:none;color:#aaa;transition:.3s;font-size:14px;background:#1e1e1e;padding:0 5px;
    }
    .form-group input:focus + label, .form-group input:not(:placeholder-shown) + label,
    .form-group select:focus + label, .form-group select:not([value=""]) + label,
    .form-group textarea:focus + label, .form-group textarea:not(:placeholder-shown) + label{
      top:-10px;left:10px;font-size:12px;color:#0b5ed7;
    }
    button.primary{width:100%;padding:15px;background:linear-gradient(90deg,#0b5ed7,#084298);color:#fff;font-size:17px;border:none;border-radius:10px;cursor:pointer;font-weight:bold;transition:.3s;}
    button.primary:hover{background:linear-gradient(90deg,#084298,#0b5ed7);transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,.6);}
    .mensaje{text-align:center;margin-top:20px;font-weight:bold;font-size:16px;}
    #recibo{display:none;background:#2a2a2a;margin-top:30px;padding:20px;border-radius:10px;}
    #recibo h3{text-align:center;margin-bottom:20px;}
    a#linkAcuerdo{color:#0b5ed7;text-decoration:none;font-weight:bold;cursor:pointer;}
    a#linkAcuerdo:hover{text-decoration:underline;}

    /* Modal */
    .modal{display:none;position:fixed;z-index:9999;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,.8);}
    .modal-content{background:#1e1e1e;margin:50px auto;padding:20px;border-radius:12px;width:90%;max-width:900px;color:#e0e0e0;position:relative;}
    .modal-close{position:absolute;top:10px;right:20px;font-size:26px;color:#888;cursor:pointer;}
    .modal-close:hover{color:#fff;}
    iframe#acuerdoFrame{width:100%;height:70vh;border:none;border-radius:8px;}

    /* Recibo table */
    .tabla-recibo{width:100%;border-collapse:collapse;margin-top:10px;}
    .tabla-recibo td{padding:8px;border-bottom:1px solid #444;}
    .tabla-recibo .total td{font-weight:bold;color:#0b5ed7;}
    @media(max-width:700px){ .modal-content{margin:20px;} iframe#acuerdoFrame{height:60vh;} }
  </style>
</head>
<body>
  <div class="container">
    <h2>Reserva de Servicio a Domicilio</h2>
    <form id="formCita">
      <!-- Nombre -->
      <div class="form-group">
        <i class="fas fa-user"></i>
        <input type="text" name="nombre" id="nombre" placeholder=" " required>
        <label>Nombre completo</label>
      </div>

      <!-- Tel√©fono -->
      <div class="form-group">
        <i class="fas fa-phone"></i>
        <input type="tel" name="telefono" id="telefono" placeholder=" " required>
        <label>Tel√©fono</label>
      </div>

      <!-- Correo -->
      <div class="form-group">
        <i class="fas fa-envelope"></i>
        <input type="email" name="correo" id="correo" placeholder=" " required>
        <label>Correo electr√≥nico</label>
      </div>

      <!-- Marca -->
      <div class="form-group">
        <i class="fas fa-car"></i>
        <select name="marca" id="marcaSelect" required>
          <option value="">Selecciona marca</option>
        </select>
        <label>Marca del veh√≠culo</label>
      </div>

      <!-- Modelo -->
      <div class="form-group">
        <i class="fas fa-car-side"></i>
        <select name="modelo" id="modeloSelect" required>
          <option value="">Selecciona modelo</option>
        </select>
        <label>Modelo del veh√≠culo</label>
      </div>

      <!-- Motor / C√≥digo -->
      <div class="form-group" id="motorGroup" style="display:none;">
        <i class="fas fa-cogs"></i>
        <select id="motorSelect" name="motor"></select>
        <label>Motor / C√≥digo</label>
      </div>

      <!-- A√±o -->
      <div class="form-group">
        <i class="fas fa-calendar-alt"></i>
        <input type="number" name="ano" id="ano" placeholder=" " required>
        <label>A√±o del veh√≠culo</label>
      </div>

      <!-- Aceite recomendado -->
      <div class="form-group">
        <i class="fas fa-oil-can"></i>
        <input type="text" name="aceiteRecomendado" id="aceiteRecomendado" readonly placeholder="Tipo de aceite recomendado">
        <label>Aceite recomendado</label>
      </div>

      <!-- Marca de Aceite -->
      <div class="form-group">
        <i class="fas fa-industry"></i>
        <select name="marcaAceite" id="marcaAceite" required>
          <option value="">Selecciona marca de aceite</option>
          <option value="Mobil 1">Mobil 1</option>
          <option value="Pennzoil">Pennzoil</option>
          <option value="Valvoline">Valvoline</option>
          <option value="Castrol EDGE">Castrol EDGE</option>
          <option value="Shell Helix">Shell Helix</option>
        </select>
        <label>Marca de Aceite</label>
      </div>

      <!-- Direcci√≥n -->
      <div class="form-group">
        <i class="fas fa-map-marker-alt"></i>
        <input type="text" name="direccion" id="direccion" placeholder=" " required>
        <label>Direcci√≥n del servicio</label>
      </div>

      <!-- Fecha -->
      <div class="form-group">
        <i class="fas fa-calendar-day"></i>
        <input type="date" name="fecha" id="fecha" required>
        <label>Fecha</label>
      </div>

      <!-- Hora -->
      <div class="form-group">
        <i class="fas fa-clock"></i>
        <input type="time" name="hora" id="hora" required>
        <label>Hora</label>
      </div>

      <!-- Comentarios -->
      <div class="form-group">
        <i class="fas fa-comment-dots"></i>
        <textarea name="comentarios" id="comentarios" placeholder=" "></textarea>
        <label>Comentarios adicionales</label>
      </div>

      <!-- Acuerdo -->
      <div class="form-group">
        <a id="linkAcuerdo">Leer acuerdo completo</a>
      </div>

      <!-- Firma -->
      <div class="form-group">
        <input type="text" name="firma" id="firmaInput" placeholder="Escribe tu nombre como firma digital" disabled required>
      </div>

      <!-- Ocultos -->
      <input type="hidden" name="estado" value="Pendiente">
      <input type="hidden" name="idioma" id="langField">

      <button type="submit" class="primary">Enviar Reserva</button>
    </form>

    <div class="mensaje" id="mensaje"></div>

    <!-- Recibo -->
    <div id="recibo">
      <h3>üìã Recibo de Reserva</h3>
      <div class="recibo-datos">
        <p><strong>Nombre:</strong> <span id="rNombre"></span></p>
        <p><strong>Tel√©fono:</strong> <span id="rTelefono"></span></p>
        <p><strong>Correo:</strong> <span id="rCorreo"></span></p>
        <p><strong>Marca:</strong> <span id="rMarca"></span></p>
        <p><strong>Modelo:</strong> <span id="rModelo"></span></p>
        <p><strong>A√±o:</strong> <span id="rAno"></span></p>
        <p><strong>Aceite recomendado:</strong> <span id="rAceite"></span></p>
        <p><strong>Marca de aceite seleccionada:</strong> <span id="rMarcaAceite"></span></p>
        <p><strong>Direcci√≥n:</strong> <span id="rDireccionRec"></span></p>
        <p><strong>Fecha:</strong> <span id="rFecha"></span></p>
        <p><strong>Hora:</strong> <span id="rHora"></span></p>
        <p><strong>Comentarios:</strong> <span id="rComentarios"></span></p>
        <p><strong>Firma:</strong> <span id="rFirma"></span></p>
      </div>

      <h4>üí≤ Desglose de Costos</h4>
      <table class="tabla-recibo">
        <tr><td>Aceite</td><td><span id="reciboAceiteCosto"></span></td></tr>
        <tr><td>Filtro</td><td><span id="reciboFiltro"></span></td></tr>
        <tr><td>Mano de obra</td><td><span id="reciboManoObra"></span></td></tr>
        <tr><td>Desecho</td><td><span id="reciboDesecho"></span></td></tr>
        <tr class="total"><td>Total</td><td><strong><span id="reciboTotal"></span></strong></td></tr>
      </table>
    </div>
    <!-- Modal del Acuerdo -->
    <div id="modalAcuerdo" class="modal">
      <div class="modal-content">
        <span class="modal-close">&times;</span>
        <iframe id="acuerdoFrame" title="Acuerdo de servicio"></iframe>
      </div>
    </div>

<script>
/* ===========================
   DATOS: marcasModelos (completo)
   =========================== */
const marcasModelos = [
{Marca:"Acura", Modelo:"ILX 2.4L ‚Äì 2.4L I4 DOHC i-VTEC"},
{Marca:"Acura", Modelo:"MDX 3.5L ‚Äì 3.5L V6 SOHC"},
{Marca:"Acura", Modelo:"MDX SH-AWD 3.5L ‚Äì 3.5L V6 SOHC"},
{Marca:"Acura", Modelo:"MDX Sport Hybrid 3.0L ‚Äì 3.0L V6 + H√≠brido"},
{Marca:"Acura", Modelo:"NSX 3.5L Turbo ‚Äì 3.5L V6 Twin Turbo + HEV"},
{Marca:"Acura", Modelo:"RDX 2WD 2.0L Turbo ‚Äì 2.0L I4 Turbo DOHC"},
{Marca:"Acura", Modelo:"RDX AWD 2.0L Turbo ‚Äì 2.0L I4 Turbo DOHC"},
{Marca:"Acura", Modelo:"RLX 3.5L ‚Äì 3.5L V6 SOHC"},
{Marca:"Acura", Modelo:"RLX Sport Hybrid 3.5L ‚Äì 3.5L V6 + H√≠brido"},
{Marca:"Acura", Modelo:"TLX 2.0L Turbo ‚Äì 2.0L I4 Turbo DOHC"},
{Marca:"Acura", Modelo:"TLX SH-AWD 3.5L ‚Äì 3.5L V6 SOHC"},
{Marca:"Chevrolet", Modelo:"Aveo ‚Äì 1.6L DOHC 4cyl"},
{Marca:"Chevrolet", Modelo:"Cruze ‚Äì 1.4L Turbo DOHC 4cyl"},
{Marca:"Chevrolet", Modelo:"Cruze ‚Äì 1.8L DOHC 4cyl"},
{Marca:"Chevrolet", Modelo:"Malibu ‚Äì 1.5L Turbo DOHC 4cyl"},
{Marca:"Chevrolet", Modelo:"Malibu ‚Äì 2.0L Turbo DOHC 4cyl"},
{Marca:"Chevrolet", Modelo:"Impala ‚Äì 3.6L V6 DOHC"},
{Marca:"Chevrolet", Modelo:"Camaro ‚Äì 2.0L Turbo DOHC 4cyl"},
{Marca:"Chevrolet", Modelo:"Camaro ‚Äì 3.6L V6 DOHC"},
{Marca:"Chevrolet", Modelo:"Camaro ‚Äì 6.2L V8 OHV"},
{Marca:"Chevrolet", Modelo:"Corvette ‚Äì 6.2L V8 (LT1/LT2)"},
{Marca:"Chevrolet", Modelo:"Corvette Z06 ‚Äì 6.2L Supercharged V8 (LT4)"},
{Marca:"Chevrolet", Modelo:"Trax ‚Äì 1.4L Turbo DOHC 4cyl"},
{Marca:"Chevrolet", Modelo:"Equinox ‚Äì 1.5L Turbo DOHC 4cyl"},
{Marca:"Chevrolet", Modelo:"Equinox ‚Äì 2.0L Turbo DOHC 4cyl"},
{Marca:"Chevrolet", Modelo:"Blazer ‚Äì 2.0L Turbo DOHC 4cyl"},
{Marca:"Chevrolet", Modelo:"Blazer ‚Äì 3.6L V6 DOHC"},
{Marca:"Chevrolet", Modelo:"Traverse ‚Äì 3.6L V6 DOHC"},
{Marca:"Chevrolet", Modelo:"Colorado ‚Äì 2.5L DOHC 4cyl"},
{Marca:"Chevrolet", Modelo:"Colorado ‚Äì 3.6L V6 DOHC"},
{Marca:"Chevrolet", Modelo:"Silverado 1500 ‚Äì 2.7L Turbo I4 (L3B)"},
{Marca:"Chevrolet", Modelo:"Silverado 1500 ‚Äì 5.3L V8 (L84, L83)"},
{Marca:"Chevrolet", Modelo:"Silverado 1500 ‚Äì 6.2L V8 (L87)"},
{Marca:"Chevrolet", Modelo:"Silverado 2500HD ‚Äì 6.6L V8 Gasolina (L8T)"},
{Marca:"Chevrolet", Modelo:"Tahoe ‚Äì 5.3L V8"},
{Marca:"Chevrolet", Modelo:"Suburban ‚Äì 6.2L V8"},
{Marca:"Chevrolet", Modelo:"Trailblazer ‚Äì 1.2L Turbo DOHC 3cyl"},
{Marca:"Chevrolet", Modelo:"Trailblazer ‚Äì 1.3L Turbo DOHC 3cyl"},
{Marca:"Chevrolet", Modelo:"Spark ‚Äì 1.4L DOHC 4cyl"},
{Marca:"Chevrolet", Modelo:"Sonic ‚Äì 1.4L Turbo DOHC 4cyl"},
{Marca:"Dodge", Modelo:"Dart ‚Äì 2.0L DOHC 4cyl"},
{Marca:"Dodge", Modelo:"Dart ‚Äì 1.4L Turbo MultiAir 4cyl"},
{Marca:"Dodge", Modelo:"Neon ‚Äì 2.0L SOHC 4cyl"},
{Marca:"Dodge", Modelo:"Caliber ‚Äì 1.8L DOHC 4cyl"},
{Marca:"Dodge", Modelo:"Caliber ‚Äì 2.0L DOHC 4cyl"},
{Marca:"Dodge", Modelo:"Caliber ‚Äì 2.4L DOHC 4cyl"},
{Marca:"Dodge", Modelo:"Journey ‚Äì 2.4L DOHC 4cyl"},
{Marca:"Dodge", Modelo:"Journey ‚Äì 3.6L V6 DOHC (Pentastar)"},
{Marca:"Dodge", Modelo:"Avenger ‚Äì 2.4L DOHC 4cyl"},
{Marca:"Dodge", Modelo:"Avenger ‚Äì 3.6L V6 DOHC (Pentastar)"},
{Marca:"Dodge", Modelo:"Charger ‚Äì 3.6L V6 Pentastar"},
{Marca:"Dodge", Modelo:"Charger ‚Äì 5.7L V8 HEMI"},
{Marca:"Dodge", Modelo:"Charger ‚Äì 6.4L V8 HEMI (Scat Pack)"},
{Marca:"Dodge", Modelo:"Charger ‚Äì 6.2L Supercharged V8 HEMI (Hellcat)"},
{Marca:"Dodge", Modelo:"Challenger ‚Äì 3.6L V6 Pentastar"},
{Marca:"Dodge", Modelo:"Challenger ‚Äì 5.7L V8 HEMI"},
{Marca:"Dodge", Modelo:"Challenger ‚Äì 6.4L V8 HEMI"},
{Marca:"Dodge", Modelo:"Challenger ‚Äì 6.2L Supercharged V8 HEMI (Hellcat/Demon)"},
{Marca:"Dodge", Modelo:"Durango ‚Äì 3.6L V6 Pentastar"},
{Marca:"Dodge", Modelo:"Durango ‚Äì 5.7L V8 HEMI"},
{Marca:"Dodge", Modelo:"Durango ‚Äì 6.4L V8 HEMI"},
{Marca:"Dodge", Modelo:"Grand Caravan ‚Äì 3.3L V6 OHV"},
{Marca:"Dodge", Modelo:"Grand Caravan ‚Äì 3.6L V6 Pentastar"},
{Marca:"Dodge", Modelo:"Nitro ‚Äì 3.7L V6 SOHC"},
{Marca:"Dodge", Modelo:"Nitro ‚Äì 4.0L V6 SOHC"},
{Marca:"Dodge", Modelo:"Dakota ‚Äì 3.7L V6 SOHC"},
{Marca:"Dodge", Modelo:"Dakota ‚Äì 4.7L V8 SOHC"},
{Marca:"Dodge", Modelo:"Dakota ‚Äì 5.7L V8 HEMI"},
{Marca:"Dodge", Modelo:"Ram 1500 ‚Äì 3.6L V6 Pentastar"},
{Marca:"Dodge", Modelo:"Ram 1500 ‚Äì 5.7L V8 HEMI"},
{Marca:"Dodge", Modelo:"Ram 2500/3500 ‚Äì 6.4L V8 HEMI"},
{Marca:"Dodge", Modelo:"Viper ‚Äì 8.4L V10"},
{Marca:"Honda", Modelo:"Civic ‚Äì 1.5L Turbo I4"},
{Marca:"Honda", Modelo:"Civic ‚Äì 2.0L I4"},
{Marca:"Honda", Modelo:"Civic ‚Äì 1.8L I4"},
{Marca:"Honda", Modelo:"Accord ‚Äì 1.5L Turbo I4"},
{Marca:"Honda", Modelo:"Accord ‚Äì 2.0L Turbo I4"},
{Marca:"Honda", Modelo:"Accord ‚Äì 2.4L I4"},
{Marca:"Honda", Modelo:"Accord Hybrid ‚Äì 2.0L I4 + Hybrid"},
{Marca:"Honda", Modelo:"CR-V ‚Äì 1.5L Turbo I4"},
{Marca:"Honda", Modelo:"CR-V ‚Äì 2.4L I4"},
{Marca:"Honda", Modelo:"HR-V ‚Äì 1.8L I4"},
{Marca:"Honda", Modelo:"Fit ‚Äì 1.5L I4"},
{Marca:"Honda", Modelo:"Pilot ‚Äì 3.5L V6"},
{Marca:"Honda", Modelo:"Odyssey ‚Äì 3.5L V6"},
{Marca:"Honda", Modelo:"Ridgeline ‚Äì 3.5L V6"},
{Marca:"Honda", Modelo:"Insight ‚Äì 1.5L I4 + Hybrid"},
{Marca:"Honda", Modelo:"Passport ‚Äì 3.5L V6"},
{Marca:"Honda", Modelo:"Pilot Hybrid ‚Äì 3.5L V6 + Hybrid"},
{Marca:"Honda", Modelo:"CR-V Hybrid ‚Äì 2.0L I4 + Hybrid"},
{Marca:"Toyota", Modelo:"Yaris ‚Äì 1.5L I4 DOHC"},
{Marca:"Toyota", Modelo:"Corolla ‚Äì 1.8L I4 DOHC"},
{Marca:"Toyota", Modelo:"Corolla ‚Äì 2.0L I4 DOHC"},
{Marca:"Toyota", Modelo:"Camry ‚Äì 2.5L I4 DOHC"},
{Marca:"Toyota", Modelo:"Camry ‚Äì 3.5L V6 DOHC"},
{Marca:"Toyota", Modelo:"Avalon ‚Äì 3.5L V6 DOHC"},
{Marca:"Toyota", Modelo:"Prius ‚Äì 1.8L I4 H√≠brido"},
{Marca:"Toyota", Modelo:"RAV4 ‚Äì 2.5L I4 DOHC"},
{Marca:"Toyota", Modelo:"RAV4 ‚Äì 2.5L I4 Turbo"},
{Marca:"Toyota", Modelo:"Highlander ‚Äì 3.5L V6 DOHC"},
{Marca:"Toyota", Modelo:"Sequoia ‚Äì 5.7L V8 OHV"},
{Marca:"Toyota", Modelo:"4Runner ‚Äì 4.0L V6 DOHC"},
{Marca:"Toyota", Modelo:"Tacoma ‚Äì 2.7L I4 DOHC"},
{Marca:"Toyota", Modelo:"Tacoma ‚Äì 3.5L V6 DOHC"},
{Marca:"Toyota", Modelo:"Tundra ‚Äì 4.6L V8 OHV"},
{Marca:"Toyota", Modelo:"Tundra ‚Äì 5.7L V8 OHV"},
{Marca:"Toyota", Modelo:"Sienna ‚Äì 3.5L V6 DOHC"},
{Marca:"Ford", Modelo:"Fiesta ‚Äì 1.0L I3 Turbo"},
{Marca:"Ford", Modelo:"Focus ‚Äì 2.0L I4 DOHC"},
{Marca:"Ford", Modelo:"Focus ‚Äì 1.0L EcoBoost I3"},
{Marca:"Ford", Modelo:"Fusion ‚Äì 2.5L I4 DOHC"},
{Marca:"Ford", Modelo:"Fusion ‚Äì 1.5L EcoBoost I4"},
{Marca:"Ford", Modelo:"Mustang ‚Äì 2.3L I4 Turbo"},
{Marca:"Ford", Modelo:"Mustang ‚Äì 5.0L V8"},
{Marca:"Ford", Modelo:"Explorer ‚Äì 3.5L V6 DOHC"},
{Marca:"Ford", Modelo:"Explorer ‚Äì 2.3L EcoBoost I4"},
{Marca:"Ford", Modelo:"F-150 ‚Äì 3.3L V6"},
{Marca:"Ford", Modelo:"F-150 ‚Äì 2.7L Turbo V6"},
{Marca:"Ford", Modelo:"F-150 ‚Äì 3.5L V6"},
{Marca:"Ford", Modelo:"F-150 ‚Äì 5.0L V8"},
{Marca:"Ford", Modelo:"Edge ‚Äì 2.0L Turbo I4"},
{Marca:"Ford", Modelo:"Edge ‚Äì 3.5L V6"},
{Marca:"Ford", Modelo:"Expedition ‚Äì 3.5L V6 EcoBoost"},
{Marca:"Ford", Modelo:"Escape ‚Äì 1.5L EcoBoost I3"},
{Marca:"Ford", Modelo:"Escape ‚Äì 2.0L EcoBoost I4"},
{Marca:"GMC", Modelo:"Sierra 1500 ‚Äì 4.3L V6"},
{Marca:"GMC", Modelo:"Sierra 1500 ‚Äì 5.3L V8"},
{Marca:"GMC", Modelo:"Sierra 1500 ‚Äì 6.2L V8"},
{Marca:"GMC", Modelo:"Sierra 2500HD ‚Äì 6.6L V8 Gasolina"},
{Marca:"GMC", Modelo:"Canyon ‚Äì 2.5L I4 DOHC"},
{Marca:"GMC", Modelo:"Canyon ‚Äì 3.6L V6 DOHC"},
{Marca:"GMC", Modelo:"Yukon ‚Äì 5.3L V8"},
{Marca:"GMC", Modelo:"Yukon ‚Äì 6.2L V8"},
{Marca:"GMC", Modelo:"Acadia ‚Äì 2.5L I4 DOHC"},
{Marca:"GMC", Modelo:"Acadia ‚Äì 3.6L V6 DOHC"},
{Marca:"GMC", Modelo:"Terrain ‚Äì 1.5L Turbo I4"},
{Marca:"GMC", Modelo:"Terrain ‚Äì 2.0L Turbo I4"},
{Marca:"GMC", Modelo:"Terrain ‚Äì 2.5L I4 DOHC"},
{Marca:"Hyundai", Modelo:"Sonata ‚Äì 2.5L I4"},
{Marca:"Hyundai", Modelo:"Sonata ‚Äì 1.6L Turbo I4"},
{Marca:"Hyundai", Modelo:"Sonata ‚Äì 2.5L Turbo I4"},
{Marca:"Hyundai", Modelo:"Tucson ‚Äì 2.0L I4"},
{Marca:"Hyundai", Modelo:"Palisade ‚Äì 3.8L V6"},
{Marca:"Hyundai", Modelo:"Venue ‚Äì 1.6L I4"},
{Marca:"Hyundai", Modelo:"Kona ‚Äì 2.0L I4"},
{Marca:"Hyundai", Modelo:"Santa Fe ‚Äì 2.5L Turbo I4"},
{Marca:"Hyundai", Modelo:"Creta ‚Äì 1.5L I4"},
{Marca:"Hyundai", Modelo:"Creta ‚Äì 1.5L Turbo I4"},
{Marca:"Jeep", Modelo:"Renegade ‚Äì 1.3L Turbo I4"},
{Marca:"Jeep", Modelo:"Renegade ‚Äì 2.4L I4 DOHC"},
{Marca:"Jeep", Modelo:"Compass ‚Äì 1.3L Turbo I4"},
{Marca:"Jeep", Modelo:"Compass ‚Äì 2.4L I4 DOHC"},
{Marca:"Jeep", Modelo:"Cherokee ‚Äì 2.0L Turbo I4"},
{Marca:"Jeep", Modelo:"Cherokee ‚Äì 2.4L I4 DOHC"},
{Marca:"Jeep", Modelo:"Cherokee ‚Äì 3.2L V6 DOHC"},
{Marca:"Jeep", Modelo:"Grand Cherokee ‚Äì 3.6L V6 Pentastar"},
{Marca:"Jeep", Modelo:"Grand Cherokee ‚Äì 5.7L V8 HEMI OHV"},
{Marca:"Jeep", Modelo:"Grand Cherokee ‚Äì 6.4L V8 HEMI OHV"},
{Marca:"Jeep", Modelo:"Wrangler ‚Äì 2.0L Turbo I4"},
{Marca:"Jeep", Modelo:"Wrangler ‚Äì 3.6L V6 Pentastar"},
{Marca:"Jeep", Modelo:"Wrangler ‚Äì 3.8L V6"},
{Marca:"Jeep", Modelo:"Gladiator ‚Äì 3.6L V6 Pentastar"},
{Marca:"Infiniti", Modelo:"Q50 ‚Äì 2.0L Turbo I4"},
{Marca:"Infiniti", Modelo:"Q50 ‚Äì 3.0L Twin Turbo V6"},
{Marca:"Infiniti", Modelo:"Q60 ‚Äì 2.0L Turbo I4"},
{Marca:"Infiniti", Modelo:"Q60 ‚Äì 3.0L Twin Turbo V6"},
{Marca:"Infiniti", Modelo:"QX50 ‚Äì 2.0L Turbo I4"},
{Marca:"Infiniti", Modelo:"QX55 ‚Äì 2.0L Turbo I4"},
{Marca:"Infiniti", Modelo:"QX60 ‚Äì 3.5L V6 DOHC"},
{Marca:"Infiniti", Modelo:"QX80 ‚Äì 5.6L V8 DOHC"},
{Marca:"Infiniti", Modelo:"QX70 ‚Äì 3.7L V6 DOHC"},
{Marca:"Infiniti", Modelo:"M35/M37 ‚Äì 3.5L V6 DOHC"},
{Marca:"Infiniti", Modelo:"M45 ‚Äì 4.5L V8 DOHC"},
{Marca:"Infiniti", Modelo:"FX35 ‚Äì 3.5L V6 DOHC"},
{Marca:"Infiniti", Modelo:"FX50 ‚Äì 5.0L V8 DOHC"},
{Marca:"Kia", Modelo:"Rio ‚Äì 1.6L I4 DOHC"},
{Marca:"Kia", Modelo:"Forte ‚Äì 2.0L I4 DOHC"},
{Marca:"Kia", Modelo:"Forte ‚Äì 1.6L Turbo I4"},
{Marca:"Kia", Modelo:"Optima/K5 ‚Äì 2.4L I4 DOHC"},
{Marca:"Kia", Modelo:"Optima/K5 ‚Äì 1.6L Turbo I4"},
{Marca:"Kia", Modelo:"Stinger ‚Äì 2.0L Turbo I4"},
{Marca:"Kia", Modelo:"Stinger ‚Äì 3.3L Twin Turbo V6"},
{Marca:"Kia", Modelo:"Soul ‚Äì 2.0L I4 DOHC"},
{Marca:"Kia", Modelo:"Soul ‚Äì 1.6L Turbo I4"},
{Marca:"Kia", Modelo:"Sportage ‚Äì 2.4L I4 DOHC"},
{Marca:"Kia", Modelo:"Sportage ‚Äì 2.0L Turbo I4"},
{Marca:"Kia", Modelo:"Sorento ‚Äì 2.4L I4 DOHC"},
{Marca:"Kia", Modelo:"Sorento ‚Äì 3.3L V6 DOHC"},
{Marca:"Kia", Modelo:"Telluride ‚Äì 3.8L V6 DOHC"},
{Marca:"Lexus", Modelo:"IS 200t/300 ‚Äì 2.0L Turbo I4 / 3.5L V6"},
{Marca:"Lexus", Modelo:"ES 250/350 ‚Äì 2.5L I4 / 3.5L V6"},
{Marca:"Lexus", Modelo:"GS 350 ‚Äì 3.5L V6 DOHC"},
{Marca:"Lexus", Modelo:"GS 450h ‚Äì 3.5L V6 H√≠brido"},
{Marca:"Lexus", Modelo:"RX 350 ‚Äì 3.5L V6 DOHC"},
{Marca:"Lexus", Modelo:"RX 450h ‚Äì 3.5L V6 H√≠brido"},
{Marca:"Lexus", Modelo:"NX 300 ‚Äì 2.0L Turbo I4"},
{Marca:"Lexus", Modelo:"NX 300h ‚Äì 2.5L I4 H√≠brido"},
{Marca:"Lexus", Modelo:"LX 570 ‚Äì 5.7L V8"},
{Marca:"Lexus", Modelo:"GX 460 ‚Äì 4.6L V8"},
{Marca:"Lexus", Modelo:"LC 500 ‚Äì 5.0L V8"},
{Marca:"Lexus", Modelo:"LS 500 ‚Äì 3.5L V6 Twin Turbo"},
{Marca:"Lexus", Modelo:"LS 500h ‚Äì 3.5L V6 H√≠brido"},
{Marca:"Mazda", Modelo:"Mazda2 ‚Äì 1.5L I4 DOHC"},
{Marca:"Mazda", Modelo:"Mazda3 ‚Äì 2.0L I4 DOHC"},
{Marca:"Mazda", Modelo:"Mazda3 ‚Äì 2.5L I4 DOHC"},
{Marca:"Mazda", Modelo:"Mazda6 ‚Äì 2.5L I4 DOHC"},
{Marca:"Mazda", Modelo:"CX-3 ‚Äì 2.0L I4 DOHC"},
{Marca:"Mazda", Modelo:"CX-30 ‚Äì 2.5L I4 DOHC"},
{Marca:"Mazda", Modelo:"CX-5 ‚Äì 2.5L I4 DOHC"},
{Marca:"Mazda", Modelo:"CX-9 ‚Äì 2.5L Turbo I4"},
{Marca:"Mazda", Modelo:"MX-5 Miata ‚Äì 2.0L I4 DOHC"},
{Marca:"Mazda", Modelo:"MX-5 Miata Turbo ‚Äì 2.0L Turbo I4"},
{Marca:"Nissan", Modelo:"Versa ‚Äì 1.6L I4 DOHC"},
{Marca:"Nissan", Modelo:"Sentra ‚Äì 2.0L I4 DOHC"},
{Marca:"Nissan", Modelo:"Sentra ‚Äì 1.6L Turbo I4"},
{Marca:"Nissan", Modelo:"Altima ‚Äì 2.5L I4 DOHC"},
{Marca:"Nissan", Modelo:"Altima ‚Äì 2.0L Turbo I4"},
{Marca:"Nissan", Modelo:"Maxima ‚Äì 3.5L V6 DOHC"},
{Marca:"Nissan", Modelo:"Kicks ‚Äì 1.6L I4 DOHC"},
{Marca:"Nissan", Modelo:"Rogue ‚Äì 2.5L I4 DOHC"},
{Marca:"Nissan", Modelo:"Rogue ‚Äì 1.5L Turbo I4"},
{Marca:"Nissan", Modelo:"Murano ‚Äì 3.5L V6 DOHC"},
{Marca:"Nissan", Modelo:"Pathfinder ‚Äì 3.5L V6 DOHC"},
{Marca:"Nissan", Modelo:"Armada ‚Äì 5.6L V8 DOHC"},
{Marca:"Nissan", Modelo:"Frontier ‚Äì 3.8L V6 DOHC"},
{Marca:"Nissan", Modelo:"Titan ‚Äì 5.6L V8 DOHC"},
{Marca:"Volvo", Modelo:"S60 2.0L Turbo ‚Äì 2.0L I4 Turbo"},
{Marca:"Volvo", Modelo:"S60 T5 ‚Äì 2.0L I4 Turbo"},
{Marca:"Volvo", Modelo:"S60 T6 ‚Äì 2.0L I4 Turbo / Supercharged"},
{Marca:"Volvo", Modelo:"S60 Recharge ‚Äì 2.0L I4 Turbo H√≠brido"},
{Marca:"Volvo", Modelo:"S90 2.0L Turbo ‚Äì 2.0L I4 Turbo"},
{Marca:"Volvo", Modelo:"S90 T6 ‚Äì 2.0L I4 Turbo / Supercharged"},
{Marca:"Volvo", Modelo:"S90 Recharge ‚Äì 2.0L I4 Turbo H√≠brido"},
{Marca:"Volvo", Modelo:"V60 2.0L Turbo ‚Äì 2.0L I4 Turbo"},
{Marca:"Volvo", Modelo:"V60 T6 ‚Äì 2.0L I4 Turbo / Supercharged"},
{Marca:"Volvo", Modelo:"V60 Recharge ‚Äì 2.0L I4 Turbo H√≠brido"},
{Marca:"Volvo", Modelo:"XC40 2.0L Turbo ‚Äì 2.0L I4 Turbo"},
{Marca:"Volvo", Modelo:"XC40 T5 ‚Äì 2.0L I4 Turbo"},
{Marca:"Volvo", Modelo:"XC60 2.0L Turbo ‚Äì 2.0L I4 Turbo"},
{Marca:"Volvo", Modelo:"XC60 T6 ‚Äì 2.0L I4 Turbo / Supercharged"},
{Marca:"Volvo", Modelo:"XC60 Recharge ‚Äì 2.0L I4 Turbo H√≠brido"},
{Marca:"Volvo", Modelo:"XC90 2.0L Turbo ‚Äì 2.0L I4 Turbo"},
{Marca:"Volvo", Modelo:"XC90 T6 ‚Äì 2.0L I4 Turbo / Supercharged"},
{Marca:"Volvo", Modelo:"XC90 Recharge ‚Äì 2.0L I4 Turbo H√≠brido"},
{Marca:"Mercedes-Benz", Modelo:"A220 ‚Äì 2.0L I4 Turbo (Engine Code 274.920)"},
{Marca:"Mercedes-Benz", Modelo:"CLA250 ‚Äì 2.0L I4 Turbo (Engine Code 274.920)"},
{Marca:"Mercedes-Benz", Modelo:"GLA250 ‚Äì 2.0L I4 Turbo (Engine Code 274.920)"},
{Marca:"Mercedes-Benz", Modelo:"GLB250 ‚Äì 2.0L I4 Turbo (Engine Code 274.920)"},
{Marca:"Mercedes-Benz", Modelo:"GLC300 ‚Äì 2.0L I4 Turbo (Engine Code 274.920)"},
{Marca:"Mercedes-Benz", Modelo:"GLE350 ‚Äì 3.5L V6 (Engine Code 276.952)"},
{Marca:"Mercedes-Benz", Modelo:"GLS450 ‚Äì 3.0L I6 Turbo (Engine Code M256)"},
{Marca:"Mercedes-Benz", Modelo:"G550 ‚Äì 4.0L V8 (Engine Code M176)"},
{Marca:"Mercedes-Benz", Modelo:"E350 ‚Äì 3.5L V6 (Engine Code 276.952)"},
{Marca:"Mercedes-Benz", Modelo:"S450 ‚Äì 3.0L I6 Turbo (Engine Code M256)"},
{Marca:"Mercedes-Benz", Modelo:"S560 ‚Äì 4.0L V8 (Engine Code M176)"},
{Marca:"Mercedes-Benz", Modelo:"C300 ‚Äì 2.0L I4 Turbo (Engine Code 274.920)"},
{Marca:"Mercedes-Benz", Modelo:"C43 AMG ‚Äì 3.0L V6 Biturbo (Engine Code M276)"},
{Marca:"Mercedes-Benz", Modelo:"E450 ‚Äì 3.0L V6 Turbo (Engine Code M256)"},
{Marca:"Mercedes-Benz", Modelo:"GLE450 ‚Äì 3.0L V6 Turbo (Engine Code M256)"},
{Marca:"Mercedes-Benz", Modelo:"GLS580 ‚Äì 4.0L V8 Turbo (Engine Code M176)"},
{Marca:"Mercedes-Benz", Modelo:"G-Class (G550) ‚Äì 4.0L V8 (Engine Code M176)"},
{Marca:"Mercedes-Benz", Modelo:"G-Class (G63 AMG) ‚Äì 4.0L V8 Biturbo (Engine Code M177)"},
{Marca:"Mercedes-Benz", Modelo:"GLK350 ‚Äì 3.5L V6 (Engine Code 276.952)"},
{Marca:"Mercedes-Benz", Modelo:"GL550 ‚Äì 4.7L V8 (Engine Code M157)"},
{Marca:"Mercedes-Benz", Modelo:"SLC300 ‚Äì 2.0L I4 Turbo (Engine Code 274.920)"},
{Marca:"Mercedes-Benz", Modelo:"SL450 ‚Äì 3.0L V6 Turbo (Engine Code M276)"},
{Marca:"Mercedes-Benz", Modelo:"SL550 ‚Äì 4.7L V8 (Engine Code M157)"},
{Marca:"Mercedes-Benz", Modelo:"GLA250 4MATIC ‚Äì 2.0L I4 Turbo (Engine Code 274.920)"},
{Marca:"Mercedes-Benz", Modelo:"GLB250 4MATIC ‚Äì 2.0L I4 Turbo (Engine Code 274.920)"},
{Marca:"Mercedes-Benz", Modelo:"GLC300 4MATIC ‚Äì 2.0L I4 Turbo (Engine Code 274.920)"},
{Marca:"Mercedes-Benz", Modelo:"GLE350 4MATIC ‚Äì 3.5L V6 (Engine Code 276.952)"},
{Marca:"Mercedes-Benz", Modelo:"GLS450 4MATIC ‚Äì 3.0L I6 Turbo (Engine Code M256)"},
{Marca:"Mercedes-Benz", Modelo:"G550 4MATIC ‚Äì 4.0L V8 (Engine Code M176)"},
{Marca:"Mercedes-Benz", Modelo:"S450 4MATIC ‚Äì 3.0L I6 Turbo (Engine Code M256)"},
{Marca:"Mercedes-Benz", Modelo:"S560 4MATIC ‚Äì 4.0L V8 (Engine Code M176)"},
{Marca:"Mercedes-Benz", Modelo:"C300 4MATIC ‚Äì 2.0L I4 Turbo (Engine Code 274.920)"},
{Marca:"Mercedes-Benz", Modelo:"E350 4MATIC ‚Äì 3.5L V6 (Engine Code 276.952)"},
{Marca:"Mercedes-Benz", Modelo:"SLC300 4MATIC ‚Äì 2.0L I4 Turbo (Engine Code 274.920)"},
{Marca:"Mercedes-Benz", Modelo:"SL450 4MATIC ‚Äì 3.0L V6 Turbo (Engine Code M276)"},
{Marca:"Mercedes-Benz", Modelo:"SL550 4MATIC ‚Äì 4.7L V8 (Engine Code M157)"},
{Marca:"Audi", Modelo:"A1 1.0 TFSI ‚Äì CHZE / CHZB"},
{Marca:"Audi", Modelo:"A1 1.2 TFSI ‚Äì CBZA"},
{Marca:"Audi", Modelo:"A1 1.4 TFSI ‚Äì CAXA / CNVA"},
{Marca:"Audi", Modelo:"A3 1.6 ‚Äì BGU / BSE"},
{Marca:"Audi", Modelo:"A4 1.8 T ‚Äì BFB / BEX"},
{Marca:"Audi", Modelo:"A4 2.0 TFSI ‚Äì CAEB / CPMA"},
{Marca:"Audi", Modelo:"A5 2.0 TFSI ‚Äì CAEB / CPMA"},
{Marca:"Audi", Modelo:"A5 2.0 TSI ‚Äì EA888 / DCGA"},
{Marca:"Audi", Modelo:"A7 3.0 TFSI ‚Äì CREC / CGWB"},
{Marca:"Audi", Modelo:"A8 3.0 TFSI ‚Äì CGWA / CREC"},
{Marca:"Audi", Modelo:"A8 4.0 TFSI ‚Äì CEUA / CTFA"},
{Marca:"Audi", Modelo:"Q2 1.0 TFSI ‚Äì CHZB"},
{Marca:"Audi", Modelo:"Q3 1.5 TFSI ‚Äì DADA / DACA"},
{Marca:"Audi", Modelo:"Q3 2.0 TFSI ‚Äì CZPA / DNVB"},
{Marca:"Audi", Modelo:"Q3 Sportback 1.5 TFSI ‚Äì DADA / DACA"},
{Marca:"Audi", Modelo:"Q3 Sportback 2.0 TFSI ‚Äì CZPA / DNVB"},
{Marca:"Audi", Modelo:"Q5 2.0 TFSI ‚Äì CAEB / CPMA"},
{Marca:"Audi", Modelo:"Q8 3.0 TFSI ‚Äì CREC / DLZA"},
{Marca:"Audi", Modelo:"TT 1.8 T ‚Äì AJQ / APP"},
{Marca:"Audi", Modelo:"TT 2.0 TFSI ‚Äì BWA / CESA"},
{Marca:"Audi", Modelo:"R8 4.2 V8 ‚Äì BYH / CFSA"},
{Marca:"Audi", Modelo:"R8 5.2 V10 ‚Äì CEUA / CNDA"},
{Marca:"Audi", Modelo:"RS3 2.5 TFSI ‚Äì DAZA / CZGB"},
{Marca:"Audi", Modelo:"RS4 4.2 V8 ‚Äì BNS / CFSA"},
{Marca:"Audi", Modelo:"RS5 2.9 TFSI ‚Äì DECA / DECD"},
{Marca:"Audi", Modelo:"RS6 4.0 TFSI ‚Äì CEUA / CRDB"},
{Marca:"Audi", Modelo:"RS7 4.0 TFSI ‚Äì CRDB / CTFA"},
{Marca:"Audi", Modelo:"S3 2.0 TFSI ‚Äì CJXA / DNUE"},
{Marca:"Audi", Modelo:"S4 3.0 TFSI ‚Äì CREC / CGWC"},
{Marca:"Audi", Modelo:"S5 3.0 TFSI ‚Äì CREC / CGWC"},
{Marca:"Audi", Modelo:"S6 4.0 TFSI ‚Äì CTFA / CRDB"},
{Marca:"Audi", Modelo:"S7 4.0 TFSI ‚Äì CTFA / CRDB"},
{Marca:"Audi", Modelo:"S8 4.0 TFSI ‚Äì CTFA / CRDB"},
{Marca:"Audi", Modelo:"SQ5 3.0 TFSI ‚Äì CREC / CGWB"},
{Marca:"BMW", Modelo:"116i (E87) ‚Äì N45 / N43"},
{Marca:"BMW", Modelo:"118i (F20) ‚Äì N13 / B38"},
{Marca:"BMW", Modelo:"120i (E87/F20) ‚Äì N46 / N20"},
{Marca:"BMW", Modelo:"125i (F20) ‚Äì N52 / B48"},
{Marca:"BMW", Modelo:"316i (E90) ‚Äì N43 / N45"},
{Marca:"BMW", Modelo:"318i (E90/F30) ‚Äì N46 / N20 / B38"},
{Marca:"BMW", Modelo:"320i (E90/F30) ‚Äì N46 / N20 / B48"},
{Marca:"BMW", Modelo:"325i (E90) ‚Äì N52 / M54"},
{Marca:"BMW", Modelo:"328i (F30) ‚Äì N20 / B48"},
{Marca:"BMW", Modelo:"330i (F30/G20) ‚Äì B48"},
{Marca:"BMW", Modelo:"335i (E90/F30) ‚Äì N54 / N55"},
{Marca:"BMW", Modelo:"340i (F30/G20) ‚Äì B58"},
{Marca:"BMW", Modelo:"520i (F10) ‚Äì N20 / B48"},
{Marca:"BMW", Modelo:"528i (F10) ‚Äì N52 / N20"},
{Marca:"BMW", Modelo:"530i (G30) ‚Äì B48"},
{Marca:"BMW", Modelo:"325i (E90)"},
{Marca:"BMW", Modelo:"328i (F30)"},
{Marca:"BMW", Modelo:"330i (F30/G20)"},
{Marca:"BMW", Modelo:"335i (E90/F30)"},
{Marca:"BMW", Modelo:"340i (F30/G20)"},
{Marca:"BMW", Modelo:"520i (F10)"},
{Marca:"BMW", Modelo:"528i (F10)"},
{Marca:"BMW", Modelo:"530i (G30)"},
{Marca:"BMW", Modelo:"535i (F10)"},
{Marca:"BMW", Modelo:"540i (G30)"},
{Marca:"BMW", Modelo:"730i (G11)"},
{Marca:"BMW", Modelo:"740i (G11)"},
{Marca:"BMW", Modelo:"M2 (F87)"},
{Marca:"BMW", Modelo:"M3 (E90/F80)"},
{Marca:"BMW", Modelo:"M4 (F82/G82)"},
{Marca:"BMW", Modelo:"M5 (E60/F90)"},
{Marca:"BMW", Modelo:"M6 (E63/F13)"},
{Marca:"BMW", Modelo:"Z4 2.0i"},
{Marca:"BMW", Modelo:"Z4 3.0i"},
  /* agrega m√°s si hace falta */
];

/* ===========================
   Variables y referencias DOM
   =========================== */
const marcaSelect = document.getElementById("marcaSelect");
const modeloSelect = document.getElementById("modeloSelect");
const motorGroup = document.getElementById("motorGroup");
const motorSelect = document.getElementById("motorSelect");
const aceiteInput = document.getElementById("aceiteRecomendado");
const marcaAceiteSelect = document.getElementById("marcaAceite");
const precioBox = document.createElement("div");
precioBox.id = "precioBox";
precioBox.style.marginTop = "12px";
precioBox.style.fontWeight = "700";
document.querySelector("form").appendChild(precioBox);

/* Poblar marcas √∫nicas */
const marcasUnicas = [...new Set(marcasModelos.map(m => m.Marca))].sort();
marcasUnicas.forEach(m => {
  const opt = document.createElement("option");
  opt.value = m;
  opt.textContent = m;
  marcaSelect.appendChild(opt);
});

/* Cuando cambia la marca, poblar modelos */
marcaSelect.addEventListener("change", () => {
  const marca = marcaSelect.value;
  modeloSelect.innerHTML = `<option value="">Selecciona modelo</option>`;
  motorSelect.innerHTML = "";
  motorGroup.style.display = "none";
  aceiteInput.value = "";

  marcasModelos.filter(x => x.Marca === marca).forEach(x => {
    const opt = document.createElement("option");
    opt.value = x.Modelo;
    opt.textContent = x.Modelo;
    modeloSelect.appendChild(opt);
  });
});

/* URL Apps Script */
<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxwOEasLVXdF0thNVAdGj08Y_5m5Drk62tHx6qK1IomZOExgWtpIwrIShAfR2KGo0a1sg/exec";
const formCita = document.getElementById("formCita");

/* ===========================
   CAMBIO DE MODELO: obtener aceite y motores
   =========================== */
modeloSelect.addEventListener("change", async () => {
  const marca = marcaSelect.value;
  const modelo = modeloSelect.value;
  if (!marca || !modelo) {
    aceiteInput.value = "";
    return;
  }

  try {
    const queryParams = new URLSearchParams({
      action: "obtenerAceiteRecomendado",
      marca,
      modelo
    }).toString();

    const resp = await fetch(`${SCRIPT_URL}?${queryParams}`);
    const data = await resp.json();

    aceiteInput.value = data.aceite || "";
    motorSelect.innerHTML = "";

    if (data.motores && data.motores.length) {
      data.motores.forEach(m => {
        const o = document.createElement("option");
        o.value = m;
        o.textContent = m;
        motorSelect.appendChild(o);
      });
      motorGroup.style.display = "block";
    } else {
      motorGroup.style.display = "none";
    }
  } catch (err) {
    console.error("Error al obtener datos del script:", err);
    aceiteInput.value = "Error conexi√≥n";
  }
});

/* ===========================
   CAMBIO DE MARCA DE ACEITE: calcular precio
   =========================== */
marcaAceiteSelect.addEventListener("change", async () => {
  const marcaAceite = marcaAceiteSelect.value;
  const modelo = modeloSelect.value;
  const motor = motorSelect.value || "";
  const aceiteRecomendado = aceiteInput.value || "";

  if (!marcaAceite || !modelo || !aceiteRecomendado) return;

  try {
    const queryParams = new URLSearchParams({
      action: "calcularPrecio",
      marcaAceite,
      modelo,
      motor,
      aceiteRecomendado
    }).toString();

    const resp = await fetch(`${SCRIPT_URL}?${queryParams}`);
    const data = await resp.json();

    precioBox.textContent = data.total
      ? `üí≤ Precio estimado: ${data.total}`
      : "üí≤ Precio estimado: N/A";

    document.getElementById("reciboAceiteCosto").textContent = data.aceite || "";
    document.getElementById("reciboFiltro").textContent = data.filtro || "";
    document.getElementById("reciboManoObra").textContent = data.manoObra || "";
    document.getElementById("reciboDesecho").textContent = data.desecho || "";
    document.getElementById("reciboTotal").textContent = data.total || "";
  } catch (err) {
    console.error("Error calcular precio:", err);
  }
});

/* ===========================
   CONTROL DEL MODAL Y FIRMA
   =========================== */
document.addEventListener("DOMContentLoaded", () => {
  const modal = document.getElementById("modalAcuerdo");
  const link = document.getElementById("linkAcuerdo");
  const spanClose = document.querySelector(".modal-close");
  const acuerdoFrame = document.getElementById("acuerdoFrame");
  const firmaInput = document.getElementById("firmaInput");

  link.addEventListener("click", (e) => {
    e.preventDefault();
    acuerdoFrame.src = "acuerdo.html";
    modal.style.display = "block";
  });

  spanClose.addEventListener("click", () => { modal.style.display = "none"; });
  window.addEventListener("click", (e) => { if (e.target === modal) modal.style.display = "none"; });

  window.addEventListener("message", (event) => {
    if (event.data === "acuerdoAceptado") {
      firmaInput.disabled = false;
      localStorage.setItem("acuerdoFirmado", "true");
      modal.style.display = "none";
      alert("‚úÖ Acuerdo aceptado. Ahora puedes firmar la reserva.");
    }
  });

  if (localStorage.getItem("acuerdoFirmado") === "true") {
    firmaInput.disabled = false;
  }

  /* ===========================
     ENV√çO DE RESERVA
     =========================== */
  formCita.addEventListener("submit", async (e) => {
    e.preventDefault();
    const form = e.target;
    const data = Object.fromEntries(new FormData(form).entries());

    if (firmaInput.disabled) {
      alert("Debes aceptar el acuerdo antes de firmar y enviar la reserva.");
      return;
    }

    try {
      const queryParams = new URLSearchParams({ action: "guardarReserva", ...data }).toString();
      const res = await fetch(`${SCRIPT_URL}?${queryParams}`);
      const resultText = await res.text();
      let result;
      try {
        result = JSON.parse(resultText);
      } catch {
        result = { success: false, error: resultText };
      }

      if (result.success) {
        document.getElementById("mensaje").textContent = "‚úÖ Reserva enviada con √©xito";
        document.getElementById("recibo").style.display = "block";
        document.getElementById("rNombre").textContent = data.nombre || "";
        document.getElementById("rTelefono").textContent = data.telefono || "";
        document.getElementById("rCorreo").textContent = data.correo || "";
        document.getElementById("rMarca").textContent = data.marca || "";
        document.getElementById("rModelo").textContent = data.modelo || "";
        document.getElementById("rAno").textContent = data.ano || "";
        document.getElementById("rAceite").textContent = data.aceiteRecomendado || "";
        document.getElementById("rMarcaAceite").textContent = data.marcaAceite || "";
        document.getElementById("rDireccionRec").textContent = data.direccion || "";
        document.getElementById("rFecha").textContent = data.fecha || "";
        document.getElementById("rHora").textContent = data.hora || "";
        document.getElementById("rComentarios").textContent = data.comentarios || "";
        document.getElementById("rFirma").textContent = data.firma || "";
      } else {
        document.getElementById("mensaje").textContent = "‚ùå Error al enviar la reserva";
        console.error("Error del servidor:", result.error);
      }
    } catch (err) {
      console.error("Error al enviar reserva:", err);
      document.getElementById("mensaje").textContent = "‚ùå Error de conexi√≥n";
    }
  });
});
</script>
  </div> <!-- .container -->
</body>
</html>
