<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reserva Cambio de Aceite</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<style>
  *{box-sizing:border-box;margin:0;padding:0;font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;}
  body{background-color:#121212;color:#e0e0e0;display:flex;justify-content:center;align-items:flex-start;min-height:100vh;padding:40px 10px;}
  .container{background:#1e1e1e;border-radius:12px;box-shadow:0 8px 25px rgba(0,0,0,0.7);padding:40px 30px;max-width:600px;width:100%;}
  h2{text-align:center;margin-bottom:30px;font-size:28px;color:#ffffff;}
  .idiomas{text-align:right;margin-bottom:25px;}
  .idiomas img{width:30px;height:20px;cursor:pointer;margin-left:8px;border-radius:3px;border:1px solid #333;transition:transform 0.2s;}
  .idiomas img:hover{transform:scale(1.2);}
  .form-group{position:relative;margin-bottom:25px;}
  .form-group i{position:absolute;top:50%;left:12px;transform:translateY(-50%);color:#888;font-size:16px;}
  .form-group input, .form-group select, .form-group textarea{
    width:100%;padding:14px 12px 14px 38px;border-radius:8px;border:none;background-color:#2a2a2a;color:#e0e0e0;font-size:15px;transition:all 0.3s ease;
  }
  .form-group input:focus, .form-group select:focus, .form-group textarea:focus{
    outline:none;background-color:#333;box-shadow:0 0 8px #0b5ed7;
  }
  .form-group textarea{min-height:80px;resize:vertical;}
  .form-group label{
    position:absolute;top:50%;left:38px;transform:translateY(-50%);
    pointer-events:none;color:#aaa;transition:0.3s;font-size:14px;background:#1e1e1e;padding:0 5px;
  }
  .form-group input:focus + label, .form-group input:not(:placeholder-shown) + label,
  .form-group select:focus + label, .form-group select:not([value=""]) + label,
  .form-group textarea:focus + label, .form-group textarea:not(:placeholder-shown) + label{
    top:-10px; left:10px; font-size:12px; color:#0b5ed7;
  }
  .agreement-container{margin-bottom:20px;text-align:left;}
  .agreement-container a{color:#0b5ed7;text-decoration:underline;font-size:13px;display:inline-block;margin-top:5px;cursor:pointer;}
  .firma-container{margin-bottom:20px;}
  .firma-container input{width:100%;padding:10px;border-radius:8px;border:none;background-color:#2a2a2a;color:#e0e0e0;font-size:15px;}
  button[type="submit"]{width:100%;padding:15px;background:linear-gradient(90deg,#0b5ed7,#084298);color:white;font-size:17px;border:none;border-radius:10px;cursor:pointer;font-weight:bold;transition:all 0.3s ease;}
  button[type="submit"]:hover{background:linear-gradient(90deg,#084298,#0b5ed7);transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,0.6);}
  .mensaje{text-align:center;margin-top:20px;font-weight:bold;font-size:16px;}
  #recibo{display:none;background:#2a2a2a;margin-top:30px;padding:20px;border-radius:10px;color:#fff;}
  #recibo h3{text-align:center;margin-bottom:20px;}
  .modal{display:none;position:fixed;z-index:9999;left:0;top:0;width:100%;height:100%;overflow:auto;background:rgba(0,0,0,0.8);}
  .modal-content{background:#1e1e1e;margin:50px auto;padding:20px;border-radius:12px;width:90%;max-width:700px;color:#e0e0e0;max-height:80vh;overflow-y:auto;}
  .modal-close{float:right;font-size:24px;color:#888;cursor:pointer;transition:color 0.2s;}
  .modal-close:hover{color:#fff;}
  @media(max-width:600px){.container{padding:30px 20px;}h2{font-size:24px;}}
</style>
</head>
<body>

<div class="container">
  <div class="idiomas"></div>

  <h2 id="titulo">Reserva de Servicio a Domicilio</h2>

  <form id="formCita">
    <div class="form-group">
      <i class="fas fa-user"></i>
      <input type="text" name="Nombre" placeholder=" " required>
      <label id="lblNombre">Nombre completo</label>
    </div>

    <div class="form-group">
      <i class="fas fa-phone"></i>
      <input type="tel" name="Telefono" placeholder=" " required>
      <label id="lblTelefono">Tel√©fono</label>
    </div>

    <div class="form-group">
      <i class="fas fa-envelope"></i>
      <input type="email" name="Correo" placeholder=" " required>
      <label id="lblCorreo">Correo electr√≥nico</label>
    </div>
    
    <!-- Marca din√°mica -->
    <div class="form-group">
      <i class="fas fa-car"></i>
      <select name="Marca" id="selectMarcaVehiculo" required>
        <option value="">Selecciona marca</option>
      </select>
      <label id="lblMarca">Marca del veh√≠culo</label>
    </div>

    <!-- Modelo din√°mico -->
    <div class="form-group">
      <i class="fas fa-car-side"></i>
      <select name="Modelo" id="selectModeloVehiculo" required>
        <option value="">Selecciona modelo</option>
      </select>
      <label id="lblModelo">Modelo del veh√≠culo</label>
    </div>

    <div class="form-group">
      <i class="fas fa-calendar-alt"></i>
      <input type="number" name="Ano" placeholder=" " required>
      <label id="lblAno">A√±o del veh√≠culo</label>
    </div>

    <div class="form-group">
      <i class="fas fa-oil-can"></i>
      <select name="TipoAceite" id="selectTipoAceite" required>
        <option value="">Selecciona tipo de aceite</option>
        <option value="0W20">0W20</option>
        <option value="0W30">0W30</option>
        <option value="5W20">5W20</option>
        <option value="5W30">5W30</option>
      </select>
      <label id="lblAceite">Tipo de Aceite</label>
    </div>

    <div class="form-group">
      <i class="fas fa-oil-can"></i>
      <select name="MarcaAceite" id="selectMarca" required>
        <option value="">Selecciona marca de aceite</option>
      </select>
      <label id="lblMarcaAceite">Marca de Aceite</label>
    </div>

    <div class="form-group">
      <textarea id="descripcionAceite" readonly placeholder="Descripci√≥n del aceite seleccionado"></textarea>
    </div>

    <div class="form-group">
      <i class="fas fa-map-marker-alt"></i>
      <input type="text" name="Direccion" placeholder=" " required>
      <label id="lblDireccion">Direcci√≥n del servicio</label>
    </div>

    <div class="form-group">
      <i class="fas fa-calendar-day"></i>
      <input type="date" name="Fecha" placeholder=" " required>
      <label id="lblFecha">Fecha</label>
    </div>

    <div class="form-group">
      <i class="fas fa-clock"></i>
      <input type="time" name="Hora" placeholder=" " required>
      <label id="lblHora">Hora</label>
    </div>

    <div class="form-group">
      <i class="fas fa-comment-dots"></i>
      <textarea name="Comentarios" placeholder=" "></textarea>
      <label id="lblComentarios">Comentarios adicionales</label>
    </div>

    <div class="agreement-container">
      <a id="linkAcuerdo">Leer acuerdo completo</a>
    </div>

    <div class="firma-container">
      <input type="text" name="Firma" id="firmaInput" placeholder="Escribe tu nombre como firma digital" disabled required>
    </div>

    <input type="hidden" name="Estado" value="Pendiente">
    <input type="hidden" id="langField" name="Idioma">
    <button type="submit" id="btnEnviar">Enviar Reserva</button>
  </form>

  <div class="mensaje" id="mensaje"></div>

  <div id="recibo">
    <h3 id="reciboTitulo">‚úÖ Recibo de Reserva</h3>
    <p><b id="reciboLabelNombre">Nombre:</b> <span id="reciboNombre"></span></p>
    <p><b id="reciboLabelTelefono">Tel√©fono:</b> <span id="reciboTelefono"></span></p>
    <p><b id="reciboLabelCorreo">Correo:</b> <span id="reciboCorreo"></span></p>
    <p><b id="reciboLabelMarca">Marca:</b> <span id="reciboMarca"></span></p>
    <p><b id="reciboLabelModelo">Modelo:</b> <span id="reciboModelo"></span></p>
    <p><b id="reciboLabelAno">A√±o:</b> <span id="reciboAno"></span></p>
    <p><b id="reciboLabelAceite">Tipo de Aceite:</b> <span id="reciboAceite"></span></p>
    <p><b id="reciboLabelDireccion">Direcci√≥n:</b> <span id="reciboDireccion"></span></p>
    <p><b id="reciboLabelFecha">Fecha del Servicio:</b> <span id="reciboFecha"></span></p>
    <p><b id="reciboLabelHora">Hora del Servicio:</b> <span id="reciboHora"></span></p>
    <p><b id="reciboLabelComentarios">Comentarios:</b> <span id="reciboComentarios"></span></p>
    <p><b id="reciboLabelFirma">Firma:</b> <span id="reciboFirma"></span></p>
  </div>
</div>

<!-- Modal del acuerdo -->
<div id="modalAcuerdo" class="modal">
  <div class="modal-content">
    <span class="modal-close">&times;</span>
    <!-- Aqu√≠ cargamos el archivo externo -->
    <iframe id="acuerdoFrame" src="" style="width:100%; height:400px; border:none;"></iframe>
  </div>
</div>

<!-- === SCRIPT: DETECCI√ìN Y APLICACI√ìN DE IDIOMA AUTOM√ÅTICO === -->
<script>
/* Detectar idioma del navegador y elegir entre 'es','pt','en' */
window.lang = (function(){
  const nav = (navigator.languages && navigator.languages[0]) || navigator.language || 'es';
  if(!nav) return 'es';
  if(nav.toLowerCase().startsWith('pt')) return 'pt';
  if(nav.toLowerCase().startsWith('es')) return 'es';
  return 'en';
})();

/* Diccionarios */
const textosUI = {
  es: {
    titulo: "Reserva de Servicio a Domicilio",
    lblNombre: "Nombre completo",
    lblTelefono: "Tel√©fono",
    lblCorreo: "Correo electr√≥nico",
    lblMarca: "Marca del veh√≠culo",
    lblModelo: "Modelo del veh√≠culo",
    lblAno: "A√±o del veh√≠culo",
    lblAceite: "Tipo de Aceite",
    lblMarcaAceite: "Marca de Aceite",
    lblDireccion: "Direcci√≥n del servicio",
    lblFecha: "Fecha",
    lblHora: "Hora",
    lblComentarios: "Comentarios adicionales",
    linkAcuerdo: "Leer acuerdo completo",
    btnEnviar: "Enviar Reserva",
    reciboTitulo: "‚úÖ Recibo de Reserva",
    reciboLabelNombre: "Nombre:",
    reciboLabelTelefono: "Tel√©fono:",
    reciboLabelCorreo: "Correo:",
    reciboLabelMarca: "Marca:",
    reciboLabelModelo: "Modelo:",
    reciboLabelAno: "A√±o:",
    reciboLabelAceite: "Tipo de Aceite:",
    reciboLabelDireccion: "Direcci√≥n:",
    reciboLabelFecha: "Fecha del Servicio:",
    reciboLabelHora: "Hora del Servicio:",
    reciboLabelComentarios: "Comentarios:",
    reciboLabelFirma: "Firma:",
    modalTitulo: "Acuerdo de Servicio a Domicilio",
    alertaAceptar: "‚úÖ Acuerdo aceptado. Ahora puede firmar su reserva.",
    enviarExito: "‚úÖ Reserva enviada correctamente!",
    enviarError: "Problema al enviar la reserva."
  },
  en: {
    titulo: "Oil Change Booking",
    lblNombre: "Full Name",
    lblTelefono: "Phone",
    lblCorreo: "Email",
    lblMarca: "Vehicle Brand",
    lblModelo: "Vehicle Model",
    lblAno: "Vehicle Year",
    lblAceite: "Oil Type",
    lblMarcaAceite: "Oil Brand",
    lblDireccion: "Service Address",
    lblFecha: "Date",
    lblHora: "Time",
    lblComentarios: "Notes or Description",
    linkAcuerdo: "Read full agreement",
    btnEnviar: "Submit Booking",
    reciboTitulo: "‚úÖ Booking Receipt",
    reciboLabelNombre: "Name:",
    reciboLabelTelefono: "Phone:",
    reciboLabelCorreo: "Email:",
    reciboLabelMarca: "Brand:",
    reciboLabelModelo: "Model:",
    reciboLabelAno: "Year:",
    reciboLabelAceite: "Oil Type:",
    reciboLabelDireccion: "Address:",
    reciboLabelFecha: "Appointment Date:",
    reciboLabelHora: "Appointment Time:",
    reciboLabelComentarios: "Comments:",
    reciboLabelFirma: "Signature:",
    modalTitulo: "Home Service Agreement",
    alertaAceptar: "‚úÖ Agreement accepted. You can now sign your booking.",
    enviarExito: "‚úÖ Booking submitted successfully!",
    enviarError: "Problem submitting booking."
  },
  pt: {
    titulo: "Agendamento de Troca de √ìleo",
    lblNombre: "Nome completo",
    lblTelefono: "Telefone",
    lblCorreo: "E-mail",
    lblMarca: "Marca do Ve√≠culo",
    lblModelo: "Modelo do Ve√≠culo",
    lblAno: "Ano do ve√≠culo",
    lblAceite: "Tipo de √ìleo",
    lblMarcaAceite: "Marca do √ìleo",
    lblDireccion: "Endere√ßo do servi√ßo",
    lblFecha: "Data",
    lblHora: "Hora",
    lblComentarios: "Observa√ß√µes ou Descri√ß√£o",
    linkAcuerdo: "Ler o acordo completo",
    btnEnviar: "Enviar Reserva",
    reciboTitulo: "‚úÖ Recibo de Reserva",
    reciboLabelNombre: "Nome:",
    reciboLabelTelefono: "Telefone:",
    reciboLabelCorreo: "E-mail:",
    reciboLabelMarca: "Marca:",
    reciboLabelModelo: "Modelo:",
    reciboLabelAno: "Ano:",
    reciboLabelAceite: "Tipo de √ìleo:",
    reciboLabelDireccion: "Endere√ßo:",
    reciboLabelFecha: "Data do Servi√ßo:",
    reciboLabelHora: "Hora do Servi√ßo:",
    reciboLabelComentarios: "Coment√°rios:",
    reciboLabelFirma: "Assinatura:",
    modalTitulo: "Acordo de Servi√ßo a Domic√≠lio",
    alertaAceptar: "‚úÖ Acordo aceito. Agora voc√™ pode assinar sua reserva.",
    enviarExito: "‚úÖ Reserva enviada com sucesso!",
    enviarError: "Problema ao enviar a reserva."
  }
};
</script>
<script>
/* funci√≥n que aplica la traducci√≥n a los elementos por id */
function applyTranslations(){
  const t = textosUI[window.lang] || textosUI.es;

  // textos simples (elementos con id)
  const map = {
    'titulo': 'titulo',
    'lblNombre': 'lblNombre',
    'lblTelefono': 'lblTelefono',
    'lblCorreo': 'lblCorreo',
    'lblMarca': 'lblMarca',
    'lblModelo': 'lblModelo',
    'lblAno': 'lblAno',
    'lblAceite': 'lblAceite',
    'lblMarcaAceite': 'lblMarcaAceite',
    'lblDireccion': 'lblDireccion',
    'lblFecha': 'lblFecha',
    'lblHora': 'lblHora',
    'lblComentarios': 'lblComentarios',
    'linkAcuerdo': 'linkAcuerdo',
    'btnEnviar': 'btnEnviar',
    'reciboTitulo': 'reciboTitulo'
    // 'modalTitulo': 'modalTitulo' // solo si decides mostrar un t√≠tulo en el modal
  };

  Object.keys(map).forEach(id=>{
    const el = document.getElementById(id);
    if(!el) return;
    const key = map[id];
    el.textContent = t[key] || el.textContent;
  });

  // traducir las etiquetas dentro del recibo
  const reciboMap = [
    'reciboLabelNombre','reciboLabelTelefono','reciboLabelCorreo','reciboLabelMarca',
    'reciboLabelModelo','reciboLabelAno','reciboLabelAceite','reciboLabelDireccion',
    'reciboLabelFecha','reciboLabelHora','reciboLabelComentarios','reciboLabelFirma'
  ];
  reciboMap.forEach(id=>{
    const el = document.getElementById(id);
    if(el && t[id]) {
      el.textContent = t[id];
    }
  });

  // colocar el idioma detectado en el campo oculto del formulario
  const langField = document.getElementById('langField');
  if(langField) langField.value = window.lang;
}

/* Ejecutar la aplicaci√≥n de traducciones ahora */
applyTranslations();

/* exportar texto de mensajes */
window.i18n = {
  aceptarAlerta: textosUI[window.lang].alertaAceptar || textosUI.es.alertaAceptar,
  enviarExito: textosUI[window.lang].enviarExito || textosUI.es.enviarExito,
  enviarError: textosUI[window.lang].enviarError || textosUI.es.enviarError
};
</script>

<!-- Modal del acuerdo -->
<div id="modalAcuerdo" class="modal">
  <div class="modal-content">
    <span class="modal-close">&times;</span>
    <iframe id="acuerdoFrame" src="" style="width:100%; height:400px; border:none;"></iframe>
  </div>
</div>

<script>
/* ************** MODAL Y FIRMA ************** */
const modal = document.getElementById('modalAcuerdo');
const link = document.getElementById('linkAcuerdo');
const spanClose = document.querySelector('.modal-close');
const firmaInput = document.getElementById('firmaInput');
const acuerdoFrame = document.getElementById('acuerdoFrame');

// Abrir modal y cargar acuerdo.html
if (link) {
  link.onclick = (e) => {
    e.preventDefault();
    acuerdoFrame.src = 'acuerdo.html';
    modal.style.display = 'block';
  };
}

// Cerrar modal
if (spanClose) spanClose.onclick = () => { modal.style.display = 'none'; };
window.onclick = (e) => { if (e.target === modal) modal.style.display = 'none'; };

// Escuchar mensaje desde acuerdo.html
window.addEventListener('message', (event) => {
  if (event.data === 'acuerdoAceptado') {
    if (firmaInput) firmaInput.disabled = false;
    localStorage.setItem('acuerdoFirmado', 'true');
    modal.style.display = 'none';
    alert(window.i18n.aceptarAlerta);
  }
});

// Activar firma si ya acept√≥ antes
window.addEventListener('load', () => {
  if (localStorage.getItem('acuerdoFirmado') === 'true') {
    if (firmaInput) firmaInput.disabled = false;
  }
});
</script>

<script>
document.addEventListener('DOMContentLoaded', ()=>{

  /* ************** ACEITES ************** */
  const aceitesData = [
    {Tipo:"0W20", Marca:"Mobil 1", Descripcion:"Aceite sint√©tico total, excelente protecci√≥n y limpieza del motor.", Precio:25},
    {Tipo:"0W20", Marca:"Pennzoil", Descripcion:"Aceite sint√©tico con limpieza activa, ideal para motores modernos.", Precio:24},
    {Tipo:"0W20", Marca:"Valvoline", Descripcion:"Protecci√≥n avanzada contra el desgaste, buen rendimiento en fr√≠o.", Precio:27},
    {Tipo:"0W30", Marca:"Mobil 1", Descripcion:"Totalmente sint√©tico, excelente viscosidad en climas fr√≠os.", Precio:25},
    {Tipo:"0W30", Marca:"Pennzoil", Descripcion:"Reduce la fricci√≥n interna del motor y mejora la eficiencia.", Precio:25},
    {Tipo:"0W30", Marca:"Valvoline", Descripcion:"Formulado para m√°xima protecci√≥n en motores exigentes.", Precio:27},
    {Tipo:"5W20", Marca:"Mobil 1", Descripcion:"Tecnolog√≠a avanzada anti-desgaste, rendimiento √≥ptimo.", Precio:25},
    {Tipo:"5W20", Marca:"Pennzoil", Descripcion:"Mantiene el motor limpio y eficiente, buena resistencia t√©rmica.", Precio:24},
    {Tipo:"5W20", Marca:"Valvoline", Descripcion:"Buena durabilidad del motor, ideal para condiciones mixtas.", Precio:26},
    {Tipo:"5W30", Marca:"Mobil 1", Descripcion:"Excelente control de oxidaci√≥n y protecci√≥n del motor.", Precio:26},
    {Tipo:"5W30", Marca:"Pennzoil", Descripcion:"Alta limpieza y fluidez en todo tipo de temperatura.", Precio:25},
    {Tipo:"5W30", Marca:"Valvoline", Descripcion:"Protecci√≥n avanzada contra desgaste y dep√≥sitos.", Precio:27}
  ];

  const selectTipoAceite = document.getElementById('selectTipoAceite');
  const selectMarcaAceite = document.getElementById('selectMarca');
  const descripcionAceite = document.getElementById('descripcionAceite');

  if(selectTipoAceite && selectMarcaAceite){
    selectTipoAceite.addEventListener('change', ()=>{
      const tipo = selectTipoAceite.value;
      selectMarcaAceite.innerHTML = `<option value="">${
        window.lang === 'en' ? 'Select oil brand' :
        window.lang === 'pt' ? 'Selecione marca de √≥leo' :
        'Selecciona marca de aceite'
      }</option>`;
      aceitesData.filter(a=>a.Tipo===tipo).forEach(a=>{
        const opt = document.createElement('option');
        opt.value = a.Marca;
        opt.textContent = a.Marca;
        selectMarcaAceite.appendChild(opt);
      });
      descripcionAceite.value='';
    });

    selectMarcaAceite.addEventListener('change', ()=>{
      const tipo = selectTipoAceite.value;
      const marca = selectMarcaAceite.value;
      const aceite = aceitesData.find(a=>a.Tipo===tipo && a.Marca===marca);
      descripcionAceite.value = aceite ? aceite.Descripcion : '';
    });
  }

}); // üëà este cierre faltaba

/* ************** MARCAS Y MODELOS DIN√ÅMICOS ************** */
/* (aqu√≠ dejo tu lista completa intacta) */
const marcasModelos = [
  {Marca:"Acura", Modelo:"ILX 2.4L"},
  {Marca:"Acura", Modelo:"MDX 3.5L"},
  {Marca:"Acura", Modelo:"MDX SH-AWD 3.5L"},
  {Marca:"Acura", Modelo:"MDX Sport Hybrid 3.0L"},
  {Marca:"Acura", Modelo:"NSX 3.5L Turbo"},
  {Marca:"Acura", Modelo:"RDX 2WD 2.0L Turbo"},
  {Marca:"Acura", Modelo:"RDX AWD 2.0L Turbo"},
  {Marca:"Acura", Modelo:"RLX 3.5L"},
  {Marca:"Acura", Modelo:"RLX Sport Hybrid 3.5L"},
  {Marca:"Acura", Modelo:"TLX 2.0L Turbo"},
  {Marca:"Acura", Modelo:"TLX SH-AWD 3.5L"},
  {Marca:"Chevrolet", Modelo:"Aveo"},
  {Marca:"Chevrolet", Modelo:"Cruze"},
  {Marca:"Chevrolet", Modelo:"Malibu"},
  {Marca:"Chevrolet", Modelo:"Impala"},
  {Marca:"Chevrolet", Modelo:"Camaro"},
  {Marca:"Chevrolet", Modelo:"Corvette"},
  {Marca:"Chevrolet", Modelo:"Corvette Z06"},
  {Marca:"Chevrolet", Modelo:"Trax"},
  {Marca:"Chevrolet", Modelo:"Equinox"},
  {Marca:"Chevrolet", Modelo:"Blazer"},
  {Marca:"Chevrolet", Modelo:"Traverse"},
  {Marca:"Chevrolet", Modelo:"Colorado"},
  {Marca:"Chevrolet", Modelo:"Silverado 1500"},
  {Marca:"Chevrolet", Modelo:"Silverado 2500HD"},
  {Marca:"Chevrolet", Modelo:"Tahoe"},
  {Marca:"Chevrolet", Modelo:"Suburban"},
  {Marca:"Chevrolet", Modelo:"Trailblazer"},
  {Marca:"Chevrolet", Modelo:"Spark"},
  {Marca:"Chevrolet", Modelo:"Sonic"},
  {Marca:"Dodge", Modelo:"Dart"},
  {Marca:"Dodge", Modelo:"Neon"},
  {Marca:"Dodge", Modelo:"Caliber"},
  {Marca:"Dodge", Modelo:"Journey"},
  {Marca:"Dodge", Modelo:"Avenger"},
  {Marca:"Dodge", Modelo:"Charger"},
  {Marca:"Dodge", Modelo:"Challenger"},
  {Marca:"Dodge", Modelo:"Durango"},
  {Marca:"Dodge", Modelo:"Grand Caravan"},
  {Marca:"Dodge", Modelo:"Nitro"},
  {Marca:"Dodge", Modelo:"Dakota"},
  {Marca:"Dodge", Modelo:"Ram 1500"},
  {Marca:"Dodge", Modelo:"Ram 2500/3500"},
  {Marca:"Dodge", Modelo:"Viper"},
  {Marca:"Honda", Modelo:"Civic"},
  {Marca:"Honda", Modelo:"Accord"},
  {Marca:"Honda", Modelo:"Accord Hybrid"},
  {Marca:"Honda", Modelo:"CR-V"},
  {Marca:"Honda", Modelo:"HR-V"},
  {Marca:"Honda", Modelo:"Fit"},
  {Marca:"Honda", Modelo:"Pilot"},
  {Marca:"Honda", Modelo:"Odyssey"},
  {Marca:"Honda", Modelo:"Ridgeline"},
  {Marca:"Honda", Modelo:"Insight"},
  {Marca:"Honda", Modelo:"Passport"},
  {Marca:"Honda", Modelo:"Pilot Hybrid"},
  {Marca:"Honda", Modelo:"CR-V Hybrid"},
  {Marca:"Toyota", Modelo:"Yaris 1.5L"},
  {Marca:"Toyota", Modelo:"Corolla 1.8L"},
  {Marca:"Toyota", Modelo:"Corolla 2.0L"},
  {Marca:"Toyota", Modelo:"Camry 2.5L"},
  {Marca:"Toyota", Modelo:"Camry 3.5L"},
  {Marca:"Toyota", Modelo:"Avalon 3.5L"},
  {Marca:"Toyota", Modelo:"Prius 1.8L"},
  {Marca:"Toyota", Modelo:"RAV4 2.5L"},
  {Marca:"Toyota", Modelo:"RAV4 2.5L Turbo"},
  {Marca:"Toyota", Modelo:"Highlander 3.5L"},
  {Marca:"Toyota", Modelo:"Sequoia 5.7L"},
  {Marca:"Toyota", Modelo:"4Runner 4.0L"},
  {Marca:"Toyota", Modelo:"Tacoma 2.7L"},
  {Marca:"Toyota", Modelo:"Tacoma 3.5L V6"},
  {Marca:"Toyota", Modelo:"Tundra 4.6L"},
  {Marca:"Toyota", Modelo:"Tundra 5.7L"},
  {Marca:"Toyota", Modelo:"Sienna 3.5L"},
  {Marca:"Ford", Modelo:"Fiesta 1.0L Turbo"},
  {Marca:"Ford", Modelo:"Focus 2.0L"},
  {Marca:"Ford", Modelo:"Focus 1.0L EcoBoost"},
  {Marca:"Ford", Modelo:"Fusion 2.5L"},
  {Marca:"Ford", Modelo:"Fusion 1.5L EcoBoost"},
  {Marca:"Ford", Modelo:"Mustang 2.3L"},
  {Marca:"Ford", Modelo:"Mustang 5.0L"},
  {Marca:"Ford", Modelo:"Explorer 3.5L"},
  {Marca:"Ford", Modelo:"Explorer 2.3L EcoBoost"},
  {Marca:"Ford", Modelo:"F-150 3.3L"},
  {Marca:"Ford", Modelo:"F-150 2.7L Turbo"},
  {Marca:"Ford", Modelo:"F-150 3.5L V6"},
  {Marca:"Ford", Modelo:"F-150 5.0L V8"},
  {Marca:"Ford", Modelo:"Edge 2.0L Turbo"},
  {Marca:"Ford", Modelo:"Edge 3.5L V6"},
  {Marca:"Ford", Modelo:"Expedition 3.5L V6"},
  {Marca:"Ford", Modelo:"Escape 1.5L EcoBoost"},
  {Marca:"Ford", Modelo:"Escape 2.0L EcoBoost"},
  {Marca:"GMC", Modelo:"Sierra 1500 4.3L"},
  {Marca:"GMC", Modelo:"Sierra 1500 5.3L"},
  {Marca:"GMC", Modelo:"Sierra 1500 6.2L"},
  {Marca:"GMC", Modelo:"Sierra 2500HD 6.6L"},
  {Marca:"GMC", Modelo:"Canyon 2.5L"},
  {Marca:"GMC", Modelo:"Canyon 3.6L V6"},
  {Marca:"GMC", Modelo:"Yukon 5.3L"},
  {Marca:"GMC", Modelo:"Yukon 6.2L"},
  {Marca:"GMC", Modelo:"Acadia 2.5L"},
  {Marca:"GMC", Modelo:"Acadia 3.6L V6"},
  {Marca:"GMC", Modelo:"Terrain 1.5L Turbo"},
  {Marca:"GMC", Modelo:"Terrain 2.0L Turbo"},
  {Marca:"GMC", Modelo:"Terrain 2.5L"},
  {Marca:"Hyundai", Modelo:"Sonata 2.5L"},
  {Marca:"Hyundai", Modelo:"Sonata 1.6L Turbo"},
  {Marca:"Hyundai", Modelo:"Sonata 2.5L Turbo"},
  {Marca:"Hyundai", Modelo:"Tucson 2.0L"},
  {Marca:"Hyundai", Modelo:"Palisade 3.8L"},
  {Marca:"Hyundai", Modelo:"Venue 1.6L"},
  {Marca:"Hyundai", Modelo:"Kona 2.0L"},
  {Marca:"Hyundai", Modelo:"Santa Fe 2.5L Turbo"},
  {Marca:"Hyundai", Modelo:"Creta 1.5L"},
  {Marca:"Hyundai", Modelo:"Creta 1.5L Turbo"},
  {Marca:"Jeep", Modelo:"Renegade 1.3L Turbo"},
  {Marca:"Jeep", Modelo:"Renegade 2.4L"},
  {Marca:"Jeep", Modelo:"Compass 1.3L Turbo"},
  {Marca:"Jeep", Modelo:"Compass 2.4L"},
  {Marca:"Jeep", Modelo:"Cherokee 2.0L Turbo"},
  {Marca:"Jeep", Modelo:"Cherokee 2.4L"},
  {Marca:"Jeep", Modelo:"Cherokee 3.2L V6"},
  {Marca:"Jeep", Modelo:"Grand Cherokee 3.6L V6"},
  {Marca:"Jeep", Modelo:"Grand Cherokee 5.7L V8"},
  {Marca:"Jeep", Modelo:"Grand Cherokee 6.4L V8"},
  {Marca:"Jeep", Modelo:"Wrangler 2.0L Turbo"},
  {Marca:"Jeep", Modelo:"Wrangler 3.6L V6"},
  {Marca:"Jeep", Modelo:"Wrangler 3.8L V6"},
  {Marca:"Jeep", Modelo:"Gladiator 3.6L V6"},
  {Marca:"Infiniti", Modelo:"Q50 2.0L Turbo"},
  {Marca:"Infiniti", Modelo:"Q50 3.0L Twin Turbo"},
  {Marca:"Infiniti", Modelo:"Q60 2.0L Turbo"},
  {Marca:"Infiniti", Modelo:"Q60 3.0L Twin Turbo"},
  {Marca:"Infiniti", Modelo:"QX50 2.0L Turbo"},
  {Marca:"Infiniti", Modelo:"QX55 2.0L Turbo"},
  {Marca:"Infiniti", Modelo:"QX60 3.5L V6"},
  {Marca:"Infiniti", Modelo:"QX80 5.6L V8"},
  {Marca:"Infiniti", Modelo:"QX70 3.7L V6"},
  {Marca:"Infiniti", Modelo:"M35/M37 3.5L V6"},
  {Marca:"Infiniti", Modelo:"M45 4.5L V8"},
  {Marca:"Infiniti", Modelo:"FX35 3.5L V6"},
  {Marca:"Infiniti", Modelo:"FX50 5.0L V8"},
  {Marca:"Kia", Modelo:"Rio 1.6L"},
  {Marca:"Kia", Modelo:"Forte 2.0L"},
  {Marca:"Kia", Modelo:"Forte 1.6L Turbo"},
  {Marca:"Kia", Modelo:"Optima/K5 2.4L"},
  {Marca:"Kia", Modelo:"Optima/K5 1.6L Turbo"},
  {Marca:"Kia", Modelo:"Stinger 2.0L Turbo"},
  {Marca:"Kia", Modelo:"Stinger 3.3L Twin Turbo"},
  {Marca:"Kia", Modelo:"Soul 2.0L"},
  {Marca:"Kia", Modelo:"Soul 1.6L Turbo"},
  {Marca:"Kia", Modelo:"Sportage 2.4L"},
  {Marca:"Kia", Modelo:"Sportage 2.0L Turbo"},
  {Marca:"Kia", Modelo:"Sorento 2.4L"},
  {Marca:"Kia", Modelo:"Sorento 3.3L V6"},
  {Marca:"Kia", Modelo:"Telluride 3.8L"},
  {Marca:"Lexus", Modelo:"IS 200t/300"},
  {Marca:"Lexus", Modelo:"ES 250/350"},
  {Marca:"Lexus", Modelo:"GS 350"},
  {Marca:"Lexus", Modelo:"GS 450h"},
  {Marca:"Lexus", Modelo:"RX 350"},
  {Marca:"Lexus", Modelo:"RX 450h"},
  {Marca:"Lexus", Modelo:"NX 300"},
  {Marca:"Lexus", Modelo:"NX 300h"},
  {Marca:"Lexus", Modelo:"LX 570"},
  {Marca:"Lexus", Modelo:"GX 460"},
  {Marca:"Lexus", Modelo:"LC 500"},
  {Marca:"Lexus", Modelo:"LS 500"},
  {Marca:"Lexus", Modelo:"LS 500h"},
  {Marca:"Mazda", Modelo:"Mazda2 1.5L"},
  {Marca:"Mazda", Modelo:"Mazda3 2.0L"},
  {Marca:"Mazda", Modelo:"Mazda3 2.5L"},
  {Marca:"Mazda", Modelo:"Mazda6 2.5L"},
  {Marca:"Mazda", Modelo:
  "CX-3 2.0L"},
  {Marca:"Mazda", Modelo:"CX-30 2.5L"},
  {Marca:"Mazda", Modelo:"CX-5 2.5L"},
  {Marca:"Mazda", Modelo:"CX-9 2.5L Turbo"},
  {Marca:"Mazda", Modelo:"MX-5 Miata 2.0L"},
  {Marca:"Mazda", Modelo:"MX-5 Miata 2.0L Turbo"},
  {Marca:"Nissan", Modelo:"Versa 1.6L"},
  {Marca:"Nissan", Modelo:"Sentra 2.0L"},
  {Marca:"Nissan", Modelo:"Sentra 1.6L Turbo"},
  {Marca:"Nissan", Modelo:"Altima 2.5L"},
  {Marca:"Nissan", Modelo:"Altima 2.0L Turbo"},
  {Marca:"Nissan", Modelo:"Maxima 3.5L"},
  {Marca:"Nissan", Modelo:"Leaf 0L Electric"},
  {Marca:"Nissan", Modelo:"Kicks 1.6L"},
  {Marca:"Nissan", Modelo:"Rogue 2.5L"},
  {Marca:"Nissan", Modelo:"Rogue 1.5L Turbo"},
  {Marca:"Nissan", Modelo:"Murano 3.5L"},
  {Marca:"Nissan", Modelo:"Pathfinder 3.5L"},
  {Marca:"Nissan", Modelo:"Armada 5.6L"},
  {Marca:"Nissan", Modelo:"Frontier 3.8L"},
  {Marca:"Nissan", Modelo:"Titan 5.6L"},
  {Marca:"Volvo", Modelo:"S60 2.0L Turbo"},
  {Marca:"Volvo", Modelo:"S60 T5"},
  {Marca:"Volvo", Modelo:"S60 T6"},
  {Marca:"Volvo", Modelo:"S60 Recharge"},
  {Marca:"Volvo", Modelo:"S90 2.0L Turbo"},
  {Marca:"Volvo", Modelo:"S90 T6"},
  {Marca:"Volvo", Modelo:"S90 Recharge"},
  {Marca:"Volvo", Modelo:"V60 2.0L Turbo"},
  {Marca:"Volvo", Modelo:"V60 T6"},
  {Marca:"Volvo", Modelo:"V60 Recharge"},
  {Marca:"Volvo", Modelo:"XC40 2.0L Turbo"},
  {Marca:"Volvo", Modelo:"XC40 T5"},
  {Marca:"Volvo", Modelo:"XC60 2.0L Turbo"},
  {Marca:"Volvo", Modelo:"XC60 T6"},
  {Marca:"Volvo", Modelo:"XC60 Recharge"},
  {Marca:"Volvo", Modelo:"XC90 2.0L Turbo"},
  {Marca:"Volvo", Modelo:"XC90 T6"},
  {Marca:"Volvo", Modelo:"XC90 Recharge"},
 {Marca:"Mercedes-Benz", Modelo:"A220"},
{Marca:"Mercedes-Benz", Modelo:"CLA250"},
{Marca:"Mercedes-Benz", Modelo:"GLA250"},
{Marca:"Mercedes-Benz", Modelo:"GLB250"},
{Marca:"Mercedes-Benz", Modelo:"GLC300"},
{Marca:"Mercedes-Benz", Modelo:"GLE350"},
{Marca:"Mercedes-Benz", Modelo:"GLS450"},
{Marca:"Mercedes-Benz", Modelo:"G550"},
{Marca:"Mercedes-Benz", Modelo:"E350"},
{Marca:"Mercedes-Benz", Modelo:"S450"},
{Marca:"Mercedes-Benz", Modelo:"S560"},
{Marca:"Mercedes-Benz", Modelo:"C300"},
{Marca:"Mercedes-Benz", Modelo:"C43 AMG"},
{Marca:"Mercedes-Benz", Modelo:"E450"},
{Marca:"Mercedes-Benz", Modelo:"GLE450"},
{Marca:"Mercedes-Benz", Modelo:"GLS580"},
{Marca:"Mercedes-Benz", Modelo:"G-Class (G550)"},
{Marca:"Mercedes-Benz", Modelo:"G-Class (G63 AMG)"},
{Marca:"Mercedes-Benz", Modelo:"GLK350"},
{Marca:"Mercedes-Benz", Modelo:"GL550"},
{Marca:"Mercedes-Benz", Modelo:"SLC300"},
{Marca:"Mercedes-Benz", Modelo:"SL450"},
{Marca:"Mercedes-Benz", Modelo:"SL550"},
{Marca:"Mercedes-Benz", Modelo:"GLA250 4MATIC"},
{Marca:"Mercedes-Benz", Modelo:"GLB250 4MATIC"},
{Marca:"Mercedes-Benz", Modelo:"GLC300 4MATIC"},
{Marca:"Mercedes-Benz", Modelo:"GLE350 4MATIC"},
{Marca:"Mercedes-Benz", Modelo:"GLS450 4MATIC"},
{Marca:"Mercedes-Benz", Modelo:"G550 4MATIC"},
{Marca:"Mercedes-Benz", Modelo:"S450 4MATIC"},
{Marca:"Mercedes-Benz", Modelo:"S560 4MATIC"},
];

const selectMarcaVehiculo = document.getElementById('selectMarcaVehiculo');
const selectModeloVehiculo = document.getElementById('selectModeloVehiculo');

/* Cargar marcas √∫nicas en el selector al iniciar */
const marcasUnicas = [...new Set(marcasModelos.map(m=>m.Marca))];
marcasUnicas.forEach(marca=>{
  const opt = document.createElement('option');
  opt.value = marca;
  opt.textContent = marca;
  selectMarcaVehiculo.appendChild(opt);
});

/* Cuando cambia la marca, actualizar modelos */
selectMarcaVehiculo.addEventListener('change', ()=>{
  const marca = selectMarcaVehiculo.value;
  const placeholder = window.lang === 'en' ? 'Select model' :
                      window.lang === 'pt' ? 'Selecione modelo' :
                      'Selecciona modelo';
  selectModeloVehiculo.innerHTML = `<option value="">${placeholder}</option>`;
  if(marca){
    marcasModelos.filter(m=>m.Marca===marca).forEach(m=>{
      const opt = document.createElement('option');
      opt.value = m.Modelo;
      opt.textContent = m.Modelo;
      selectModeloVehiculo.appendChild(opt);
    });
  }
});

/* ************** ENV√çO GOOGLE SCRIPT ************** */
const form = document.getElementById('formCita');
const mensaje = document.getElementById('mensaje');
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxrD4EgQrlVf0N9Bm5dJ6uhllGBOvQHzpu5BJiLLZIEbM246Qqqw6TtwnXmeOiZSTislA/exec';

form.addEventListener('submit', e=>{
  e.preventDefault();
  if(firmaInput.disabled){
    alert({'es':'Debe aceptar el acuerdo antes de enviar la reserva.','en':'You must accept the agreement before submitting.','pt':'Voc√™ deve aceitar o acordo antes de enviar.'}[window.lang]);
    return;
  }
  const data = Object.fromEntries(new FormData(form).entries());
  data.callback='handleResponse';
  const script = document.createElement('script');
  script.src = SCRIPT_URL + '?' + new URLSearchParams(data).toString();
  document.body.appendChild(script);
  window.ultimoEnvio = {...data};
});

function handleResponse(response){
  if(response.success){
    mensaje.textContent = {'es':'‚úÖ Reserva enviada correctamente!','en':'‚úÖ Booking submitted successfully!','pt':'‚úÖ Reserva enviada com sucesso!'}[window.lang];
    mostrarRecibo(window.ultimoEnvio);
    form.reset();
    if(firmaInput) firmaInput.disabled=true;
    localStorage.removeItem('acuerdoFirmado');
  }else{
    mensaje.textContent = ( {'es':'Error: ','en':'Error: ','pt':'Erro: '}[window.lang] + (response.error|| {'es':'Problema al enviar la reserva.','en':'Problem submitting booking.','pt':'Problema ao enviar a reserva.'}[window.lang]) );
  }
}

function mostrarRecibo(data){
  document.getElementById('reciboNombre').innerText = data.Nombre || '';
  document.getElementById('reciboTelefono').innerText = data.Telefono || '';
  document.getElementById('reciboCorreo').innerText = data.Correo || '';
  document.getElementById('reciboMarca').innerText = data.Marca || '';
  document.getElementById('reciboModelo').innerText = data.Modelo || '';
  document.getElementById('reciboAno').innerText = data.Ano || '';
  document.getElementById('reciboAceite').innerText = (data.TipoAceite || '') + ' - ' + (data.MarcaAceite || '');
  document.getElementById('reciboDireccion').innerText = data.Direccion || '';
  document.getElementById('reciboFecha').innerText = data.Fecha || '';
  document.getElementById('reciboHora').innerText = data.Hora || '';
  document.getElementById('reciboComentarios').innerText = data.Comentarios || '';
  document.getElementById('reciboFirma').innerText = data.Firma || '';
  document.getElementById('recibo').style.display='block';
}
</script>
</body>
</html>
